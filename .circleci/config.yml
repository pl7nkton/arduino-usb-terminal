version: 2.1
orbs:
  android: circleci/android@2.1.2

jobs:
  android-test:
    executor:
      name: android/android-machine
      resource-class: large
      tag: 2022.12.1
    steps:
      - run: lsb_release -a
      - checkout
      - run: python3 scripts/generateKsPropFile.py
      - run: sdkmanager --list
      - android/create-avd:
          avd-name: myavd
          install: true
          system-image: system-images;android-31;default;x86_64
      - android/start-emulator
      - android/run-tests

workflows:
  workflow:
    jobs:
      - android-test
